#!/bin/bash
curl https://ip-ranges.amazonaws.com/ip-ranges.json | jq -r '.prefixes[] | select(.service=="AMAZON" or .service=="API_GATEWAY" or .service=="CLOUDFRONT" or .service=="EC2" or .service=="GLOBALACCELERATOR" or .service=="S3" or .service=="WORKSPACES_GATEWAYS") | .ip_prefix'
curl "https://download.microsoft.com/download/7/1/D/71D86715-5596-4529-9B13-DA13A5DE5B63/ServiceTags_Public_20210208.json" | jq -r '.values[] | select(.properties.systemService == "AzureAD" or .properties.systemService == "AzureApiManagement" or .properties.systemService == "AzureAppService" or .properties.systemService == "AzureArcInfrastructure" or .properties.systemService == "AzureBackup" or .properties.systemService == "AzureConnectors" or .properties.systemService == "AzureCosmosSB" or .properties.systemService == "AzureDevOps" or .properties.systemService == "AzureDevSpaces" or .properties.systemService == "AzureDigitalTwins" or .properties.systemService == "AzureEventGrid" or .properties.systemService == "AzureEventHub" or .properties.systemService == "AzureEventHub" or .properties.systemService == "AzureFrontDoor" or .properties.systemService == "AzureInformationProtection" or .properties.systemService == "AzureIoTHub" or .properties.systemService == "AzureSQL" or .properties.systemService == "AzureServiceBus" or .properties.systemService == "AzureSignalR" or .properties.systemService == "AzureStorage" or .properties.systemService == "AzureTrafficManager" or .properties.systemService == "BatchNodeManagement" or .properties.systemService == "GatewayManager" or .properties.systemService == "LogicApps" or .properties.systemService == "ServiceFabric" or .properties.systemService == "SqlManagement" or .properties.systemService == "WindowsVirtualDesktop") | .properties.addressPrefixes[]'
 curl "https://www.gstatic.com/ipranges/cloud.json" | jq '.prefixes[] | .ipv4Prefix' | grep -v 'null'
